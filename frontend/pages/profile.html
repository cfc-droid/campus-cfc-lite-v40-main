<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil ‚Äî Campus CFC LITE</title>
  <link rel="stylesheet" href="../css/premium.css?v=20251105" />
  <style>
    /* ‚úÖ CFC_FUNC_8_2C_20251105 ‚Äî Bot√≥n flotante modo oscuro/claro sincronizado */
    #themeToggle {
      position: fixed;
      top: 18px;
      right: 22px;
      background: rgba(255,215,0,0.2);
      border: 2px solid rgba(255,215,0,0.4);
      color: #FFD700;
      border-radius: 50%;
      width: 42px;
      height: 42px;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.3s;
      backdrop-filter: blur(8px);
      box-shadow: 0 0 10px rgba(255,215,0,0.3);
      z-index: 1000;
    }
    #themeToggle:hover { background:#FFD700; color:#000; transform:scale(1.05); }

    body.light-mode { background:#f9f9f9; color:#111; }
    body.dark-mode { background:#000; color:#e0e0e0; }

    /* ‚úÖ Bloque examen din√°mico adaptativo */
    .ultimo-examen.light { color:#111; }
    .ultimo-examen.dark { color:#fff; }
  </style>
</head>

<body>
  <header>
    <h2>üë§ Perfil del Usuario</h2>
  </header>

  <!-- üåó Bot√≥n de cambio de tema -->
  <div id="themeToggle" title="Cambiar tema">üåô</div>

  <main style="text-align:center;">
    <p>Esta es la p√°gina de Perfil del Campus CFC LITE V41 REAL.</p>

    <div style="margin-top:30px;">
      <button id="btnStats" class="btn-main">üìä Mi progreso</button>
    </div>

    <section id="emocion-section" style="margin-top:30px;">
      <h3>üß† Estado Emocional Diario</h3>
      <div id="emotionScore" style="font-size:1.5rem;margin-top:10px;font-weight:bold;color:#FFD700;"></div>
      <p id="emotionMessage" style="color:#ccc;font-size:0.9rem;margin-top:8px;"></p>
    </section>

    <div class="bitacora-access" style="margin-top:30px;">
      <button class="btn-bitacora" onclick="window.open('../pages/bitacora_v416.html?v=20251107CFC_FIX4','_blank')">
        üß† Bit√°cora Mental del Trader
      </button>
      <p style="font-size:0.85rem;color:#aaa;margin-top:6px;">Registr√° tus reflexiones y aprendizajes del d√≠a.</p>
    </div>

    <div class="return-container" style="margin-top:25px;">
      <button class="btn-return" onclick="window.location.href='../modules/index.html'">‚¨Ö Volver al Campus</button>
    </div>
  </main>

  <div id="footer-placeholder"></div>
  <script src="../js/footer.js" defer></script>
  <script src="../js/stats_v1.js" defer></script>
  <script src="../js/activity_tracker.js?v=20251106" defer></script>
  <script src="../js/theme_chapter.js?v=20251105" defer></script>

  <script>
    const scoreRaw = localStorage.getItem("emotionScore");
    const box = document.getElementById("emotionScore");
    const msg = document.getElementById("emotionMessage");
    if (scoreRaw && !isNaN(parseInt(scoreRaw))) {
      const val = parseInt(scoreRaw, 10);
      let emoji="üôÇ",mensaje="Buen enfoque mental.";
      if (val<=3){emoji="üòî";mensaje="Momento de reconectar con tu calma.";}
      else if (val<=6){emoji="üòê";mensaje="Est√°s estable, pero pod√©s mejorar tu enfoque.";}
      else if (val<=8){emoji="üòä";mensaje="Excelente disciplina emocional.";}
      else if (val<=10){emoji="üî•";mensaje="M√°xima claridad mental, segu√≠ as√≠.";}
      box.textContent=`${emoji} ${val}/10`; msg.textContent=mensaje;
    } else {
      box.textContent="‚ö†Ô∏è A√∫n no registraste tu emoci√≥n de hoy.";
      msg.textContent="Registr√° tu autoevaluaci√≥n al cargar el Campus.";
    }
  </script>

  <!-- ‚úÖ Versi√≥n adaptativa del bloque examen -->
  <script>
    function mostrarUltimoExamen() {
      try {
        const examResults = JSON.parse(localStorage.getItem("examResults")) || [];
        if (!examResults.length) return;
        const ultimo = examResults.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
        const contenedor = document.querySelector("main");
        const bloque = document.createElement("div");
        const theme = localStorage.getItem("CFC_THEME_STATE") || "dark";
        bloque.className = `ultimo-examen ${theme}`;
        bloque.style.marginTop = "35px";
        bloque.style.borderTop = "1px solid rgba(255,215,0,0.3)";
        bloque.style.paddingTop = "15px";
        bloque.style.textAlign = "center";
        bloque.style.opacity = "0.9";
        bloque.innerHTML = `
          <h3 style="color:#FFD700;font-size:1.1rem;">üìò √öltimo examen completado</h3>
          <p style="font-size:0.95rem;line-height:1.4;margin-top:6px;">
            <strong>${ultimo.module}</strong><br>
            <span style="color:inherit;">
              Puntaje: <b style="color:#FFD700;">${ultimo.score}%</b> ‚Äî ${ultimo.status}<br>
              ‚è±Ô∏è ${ultimo.duration} &nbsp;|&nbsp; üìÖ ${ultimo.date} ${ultimo.time}
            </span>
          </p>`;
        contenedor.appendChild(bloque);
      } catch (err) {
        console.warn("‚ö†Ô∏è Error al mostrar √∫ltimo examen:", err);
      }
    }
    document.addEventListener("DOMContentLoaded", mostrarUltimoExamen);
  </script>

  <!-- üîí CFC_LOCK: V41.15-profile_examThemeFix-20251105 -->
</body>
</html>
