<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil ‚Äî Campus CFC LITE</title>
  <link rel="stylesheet" href="../css/premium.css?v=20251105" />
</head>

<body>
  <header>
    <h2>üë§ Perfil del Usuario</h2>
  </header>

  <main style="text-align:center;">
    <p>Esta es la p√°gina de Perfil del Campus CFC LITE V41 REAL.</p>

    <!-- ‚úÖ CFC_FUNC_8_1_20251105 ‚Äî Bot√≥n de anal√≠tica CFC-STATS V1 -->
    <div style="margin-top:30px;">
      <button id="btnStats" class="btn-main">üìä Mi progreso</button>
    </div>

    <!-- ‚úÖ CFC_FUNC_10_2_20251101 ‚Äî Visualizaci√≥n de Autoevaluaci√≥n Emocional -->
    <section id="emocion-section" style="margin-top:30px;">
      <h3>üß† Estado Emocional Diario</h3>
      <div id="emotionScore" style="font-size:1.5rem;margin-top:10px;font-weight:bold;color:#FFD700;"></div>
      <p id="emotionMessage" style="color:#ccc;font-size:0.9rem;margin-top:8px;"></p>
    </section>

    <!-- ‚úÖ CFC_FUNC_4_3_20251107_FIX4 ‚Äî Acceso directo a Bit√°cora Mental actualizada -->
<div class="bitacora-access" style="margin-top:30px;">
  <button class="btn-bitacora" onclick="window.open('../pages/bitacora_v416.html?v=20251107CFC_FIX4','_blank')">
    üß† Bit√°cora Mental del Trader
  </button>
  <p style="font-size:0.85rem;color:#aaa;margin-top:6px;">Registr√° tus reflexiones y aprendizajes del d√≠a.</p>
</div>


    <!-- ‚úÖ CFC_FUNC_4_5_20251101_NAVBACK ‚Äî Retorno al √çndice -->
    <div class="return-container" style="margin-top:25px;">
      <button class="btn-return" onclick="window.location.href='../modules/index.html'">‚¨Ö Volver al Campus</button>
    </div>
  </main>

  <div id="footer-placeholder"></div>
  <script src="../js/footer.js" defer></script>
  <script src="../js/stats_v1.js" defer></script>
  <script src="../js/activity_tracker.js?v=20251106" defer></script>

  <!-- ‚úÖ CFC_FUNC_10_2_20251101 ‚Äî Script de visualizaci√≥n emocional -->
  <script>
    const scoreRaw = localStorage.getItem("emotionScore");
    const box = document.getElementById("emotionScore");
    const msg = document.getElementById("emotionMessage");
    if (scoreRaw && !isNaN(parseInt(scoreRaw))) {
      const val = parseInt(scoreRaw, 10);
      let emoji = "üôÇ", mensaje = "Buen enfoque mental.";
      if (val <= 3) { emoji = "üòî"; mensaje = "Momento de reconectar con tu calma."; }
      else if (val <= 6) { emoji = "üòê"; mensaje = "Est√°s estable, pero pod√©s mejorar tu enfoque."; }
      else if (val <= 8) { emoji = "üòä"; mensaje = "Excelente disciplina emocional."; }
      else if (val <= 10) { emoji = "üî•"; mensaje = "M√°xima claridad mental, segu√≠ as√≠."; }
      box.textContent = `${emoji} ${val}/10`;
      msg.textContent = mensaje;
      console.log(`üß† Estado emocional mostrado: ${val}/10 ‚Äî ${mensaje}`);
    } else {
      box.textContent = "‚ö†Ô∏è A√∫n no registraste tu emoci√≥n de hoy.";
      msg.textContent = "Registr√° tu autoevaluaci√≥n al cargar el Campus.";
      console.warn("‚ö†Ô∏è No se encontr√≥ valor emocional v√°lido en localStorage.");
    }
  </script>

  <!-- ‚úÖ CFC_FUNC_11_2_V41.2 ‚Äî Integraci√≥n con Historial de Ex√°menes -->
  <script>
    function mostrarUltimoExamen() {
      try {
        const examResults = JSON.parse(localStorage.getItem("examResults")) || [];
        if (!examResults.length) return;

        // Ordenar por fecha m√°s reciente
        const ultimo = examResults.sort((a, b) => new Date(b.date) - new Date(a.date))[0];

        // Crear contenedor visual
        const contenedor = document.querySelector("main") || document.body;
        const bloque = document.createElement("div");
        bloque.className = "ultimo-examen";
        bloque.style.marginTop = "35px";
        bloque.style.borderTop = "1px solid rgba(255,215,0,0.3)";
        bloque.style.paddingTop = "15px";
        bloque.style.textAlign = "center";
        bloque.style.opacity = "0.9";
        bloque.style.transition = "all 0.4s ease";

        bloque.innerHTML = `
          <h3 style="color:#FFD700;font-size:1.1rem;">üìò √öltimo examen completado</h3>
          <p style="color:#fff;font-size:0.95rem;line-height:1.4;margin-top:6px;">
            <strong>${ultimo.module}</strong><br>
            Puntaje: <span style="color:#FFD700;">${ultimo.score}%</span> ‚Äî ${ultimo.status}<br>
            ‚è±Ô∏è ${ultimo.duration} &nbsp;|&nbsp; üìÖ ${ultimo.date} ${ultimo.time}
          </p>
        `;

        contenedor.appendChild(bloque);
        console.log("üß© CFC_SYNC checkpoint: √öltimo examen mostrado correctamente", ultimo);
      } catch (err) {
        console.warn("‚ö†Ô∏è CFC_SYNC ‚Üí Error al mostrar √∫ltimo examen:", err);
      }
    }

    document.addEventListener("DOMContentLoaded", mostrarUltimoExamen);
  </script>

  <!-- üîí CFC_LOCK: V41.12-profile_emotion_examLink-20251106-SYNC-STATS -->
</body>
</html>
